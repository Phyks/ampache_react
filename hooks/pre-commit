# Get against which ref to diff
if git rev-parse --verify HEAD >/dev/null 2>&1
then
	against=HEAD
else
	# Initial commit
    exit 1
fi

js_files=$(git diff-index --name-only $against | grep -e ".jsx\?$" | grep -v "^app/dist")

# Nothing more to do if no JS files was committed
if [ -z "$js_files" ]
then
    exit 0
fi

echo "Rebuilding dist JavaScript filesâ€¦"
export NODE_ENV=production
npm run clean
npm run build
git add app/dist
