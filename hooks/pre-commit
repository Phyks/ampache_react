# Get against which ref to diff
if git rev-parse --verify HEAD >/dev/null 2>&1
then
	against=HEAD
else
	# Initial commit
    exit 1
fi

css_js_files=$(git diff-index --name-only $against | grep -e '.\(jsx\?\)\|\(s\?css\)$' | grep -v "^app/dist")

# Nothing more to do if no JS files was committed
if [ -z "$css_js_files" ]
then
    exit 0
fi

echo "Rebuilding dist JavaScript filesâ€¦"
npm run clean
npm run build:prod
npm test
git add app/dist
